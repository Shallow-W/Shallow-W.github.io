(()=>{function w(t,i){if(i<t.length){let e=t[i],c=e.getAttribute("src"),d=r=>new Promise((s,l)=>{let n=document.createElement("script");e.type&&(n.type=e.type),e.src&&(n.src=e.src,e.integrity&&(n.integrity=e.integrity),e.crossOrigin&&(n.crossOrigin=e.crossOrigin),n.onload=s,n.onerror=l),r&&(n.text=r),document.head.appendChild(n),e.src||s()});(c?d():d(e.text)).then(()=>w(t,i+1)).catch(r=>{console.error(`Failed to load script: ${c||"inline script"}`,r),w(t,i+1)})}}window.Pjax&&(Pjax.prototype.getElements=function(){let t=window.siteConfig.i18n_languages,i=window.siteConfig.base,e=new URL(i).pathname;e.endsWith("/")||(e+="/");let c=window.location.href,d=new URL(c).pathname.replace(e,""),r=document.querySelectorAll("a[href]"),s=[];for(let l=0;l<r.length;l++){let n=r[l],o=n.getAttribute("href");if(n.getAttribute("target")==="_blank"||n.getAttribute("rel")?.includes("noopener")||o.startsWith("mailto:")||o.startsWith("tel:")||o.startsWith("javascript:")||o.startsWith("data:")||o.startsWith("vbscript:"))continue;if(!t){s.push(n);continue}let a=new URL(o,c).href,h=new URL(a).pathname.replace(e,"");if(!h||!d){s.push(n);continue}let f=t.findIndex(u=>d.startsWith(u.Lang));f>-1?t.findIndex(m=>h.startsWith(m.Lang))===f&&s.push(n):t.findIndex(m=>h.startsWith(m.Lang))===-1&&s.push(n)}return s});window.Pjax&&new window.Pjax({selectors:["#header>img","#header>picture","head title","#header-title","#subtitle-wrap","#main","#content",".sidebar-widget",".sidebar-wrapper",".sidebar-wrapper-container","#mobile-nav","#lazy-script","#i18n-nav"],switches:{".sidebar-wrapper-container":function(t,i){t.className=i.className,this.onSwitch()},"#content":function(t,i){t.className=i.className,this.onSwitch()},"#header-title":Pjax.switches.outerHTML,"#subtitle-wrap":Pjax.switches.outerHTML,"#main":function(t,i){let e=[...i.querySelectorAll("script")];w(e,0),t.outerHTML=i.outerHTML,this.onSwitch()},"#mobile-nav":Pjax.switches.outerHTML,"#lazy-script":function(t,i){let e=[...i.querySelectorAll("script")];w(e,0),t.innerHTML=i.innerHTML,this.onSwitch()}},cacheBust:!1});window.addEventListener("pjax:success",()=>{_$$("script[data-pjax]").forEach(t=>{let{textContent:i,parentNode:e,id:c,className:d,type:r,src:s,dataset:l,integrity:n,crossOrigin:o}=t,p=i||"",a=document.createElement("script");c&&(a.id=c),d&&(a.className=d),r&&(a.type=r),l.pjax!==void 0&&(a.dataset.pjax=""),n&&(a.integrity=n),o&&(a.crossOrigin=o),s?(a.src=s,a.async=!1):p&&(a.textContent=p),e?.replaceChild(a,t)})});window.addEventListener("pjax:complete",()=>{_$("#header-nav")?.classList.remove("header-nav-hidden");let t=window.localStorage.getItem("dark_mode");document.body.dispatchEvent(new CustomEvent("reimu:theme-set",{detail:{isDark:t==="true"||t==="auto"&&window.matchMedia("(prefers-color-scheme: dark)").matches,mode:t||"auto"}})),window.walineInstance&&(window.walineInstance.destroy(),window.walineInstance=null)});window.addEventListener("pjax:send",()=>{window.__panZoomList&&(window.__panZoomList.forEach(t=>t.destroy()),window.__panZoomList=[])});window.startLoading&&window.addEventListener("pjax:send",startLoading);window.endLoading&&window.addEventListener("pjax:complete",endLoading);window.aosInit&&window.addEventListener("pjax:success",aosInit);})();
